language: csharp
mono: none
dotnet: 3.1.302

dist: bionic

git:
  submodules: false

env:
  - DOTNET_NOLOGO=true
  - DOTNET_CLI_TELEMETRY_OPTOUT=true

branches:
  only:
  - master
  - develop

stages:
  - name: restore
  - name: build
  - name: test
  - name: pack

jobs:
  include:
    - stage: restore
      script: dotnet restore UCWA.Meeting.sln
    - stage: build 
      script: dotnet build UCWA.Meeting.sln -c Release
    - stage: test
      script: dotnet test UCWA.Meeting.sln -c Release
    - stage: pack
      script:
        - dotnet pack src\UCWA.Meeting.Abstractions\UCWA.Meeting.Abstractions.csproj -c Release
        - dotnet pack src\UCWA.Meeting.Client\UCWA.Meeting.Client.csproj --include-symbols -c Release

notifications:
  email:
    on_success: never
    on_failure: change
